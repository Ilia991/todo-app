(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{21:function(e,t,n){},22:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n(15),r=n.n(o),a=(n(21),n(16)),i=n(2),s=n(8),l=n(4),u=n(5),d=n.n(u);function j(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n={method:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET"};return t&&(n.body=JSON.stringify(t),n.headers={"Content-Type":"application/json; charset=UTF-8"}),fetch("https://mate.academy/students-api"+e,n).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var m=function(e){return j(e)},O=function(e,t){return j(e,"POST",t)},b=function(e,t){return j(e,"PATCH",t)},f=function(e){return j(e,"DELETE")},p=function(e){return f("/todos/".concat(e))},h=function(e,t){return b("/todos/".concat(e),t)},E=(n(22),n(1)),_=function(e){var t=e.todo,n=e.onDelete,o=e.onUpdate,r=e.updateTodo,a=e.todoEdit,s=Object(c.useState)(!1),l=Object(i.a)(s,2),u=l[0],j=l[1],m=Object(c.useState)(t.title),O=Object(i.a)(m,2),b=O[0],f=O[1];return Object(E.jsxs)("div",{className:d()("todo",{completed:t.completed}),children:[Object(E.jsx)("label",{className:"todo__status-label",htmlFor:"checkbox",children:Object(E.jsx)("input",{id:"checkbox",type:"checkbox",className:"todo__status",checked:t.completed,onChange:function(){return o(t.id,t.completed)}})}),u?Object(E.jsx)("form",{onSubmit:function(e){return e.preventDefault()},children:Object(E.jsx)("input",{className:"todo__title-field",type:"text",value:b,onChange:function(e){return f(e.target.value)},onBlur:function(e){r(t.id,{title:e.target.value}),j(!1)},onKeyDown:function(e){return function(e,n,c){"Enter"===e.key&&(n.length>0?(r(t.id,{title:n}),j(!1)):(p(c),a(c))),"Escape"===e.key&&(f(t.title),j(!1))}(e,b,t.id)},autoFocus:!0})}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("span",{className:"todo__title",onDoubleClick:function(){return j(!0)},children:b}),Object(E.jsx)("button",{type:"button",className:"todo__remove",onClick:function(){return n(t.id)},children:"\xd7"})]})]},t.id)},N=function(e){return e[e.NONE=0]="NONE",e[e.ADD_ERROR=1]="ADD_ERROR",e[e.DELETE_ERROR=2]="DELETE_ERROR",e[e.UPDATE_ERROR=3]="UPDATE_ERROR",e}(N||{}),R=function(e){return e.ALL="all",e.ACTIVE="active",e.COMPLETED="completed",e}(R||{}),x=function(e){var t,n=e.user,o=Object(c.useState)([]),r=Object(i.a)(o,2),a=r[0],u=r[1],j=Object(c.useState)(N.NONE),b=Object(i.a)(j,2),f=b[0],x=b[1],v=Object(c.useState)(R.ALL),g=Object(i.a)(v,2),A=g[0],L=g[1],T=Object(c.useState)(""),D=Object(i.a)(T,2),k=D[0],y=D[1],C=Object(c.useState)(!1),S=Object(i.a)(C,2),I=S[0],M=S[1],U=Object(c.useMemo)((function(){return e=a,t=A,Object(l.a)(e).filter((function(e){switch(t){case R.ALL:return e;case R.ACTIVE:return!1===e.completed;case R.COMPLETED:return!0===e.completed;default:return e}}));var e,t}),[a,A]),w=a.filter((function(e){return!1===e.completed})),P=a.filter((function(e){return!0===e.completed})),F=function(){x(N.NONE),window.clearTimeout(t)},V=function(e){u(a.filter((function(t){return t.id!==e}))),p(e)},J=function(e,t){h(e,{completed:!t}),u(a.map((function(n){return n.id===e?Object(s.a)(Object(s.a)({},n),{},{completed:!t}):n})))},z=function(e){u(a.filter((function(t){return t.id!==e})))};return Object(c.useEffect)((function(){var e=setTimeout((function(){var t;(t=n.id,m("/todos?userId=".concat(t))).then((function(e){return u(e)})).catch((function(){return x(N.UPDATE_ERROR)})),clearTimeout(e)}),100)}),[]),Object(c.useEffect)((function(){t=window.setTimeout(F,3e3)}),[f]),Object(E.jsxs)("div",{className:"todoapp",children:[Object(E.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(E.jsxs)("div",{className:"todoapp__content",children:[Object(E.jsxs)("header",{className:"todoapp__header",children:[Object(E.jsx)("button",{"aria-label":"button",type:"button",className:d()("todoapp__toggle-all",{active:P.length===a.length}),onClick:function(){u(a.map((function(e){return P.length!==a.length?(h(e.id,{completed:!0}),Object(s.a)(Object(s.a)({},e),{},{completed:!0})):(h(e.id,{completed:!(P.length===a.length)}),Object(s.a)(Object(s.a)({},e),{},{completed:!(P.length===a.length)}))})))}}),Object(E.jsx)("form",{onSubmit:function(e){if(e.preventDefault(),k){var t={userId:n.id,title:k,completed:!1};M(!0),(c="/todos",o=t,O(c,o)).then((function(e){u([].concat(Object(l.a)(a),[e])),M(!1)}))}else x(N.ADD_ERROR);var c,o;y("")},children:Object(E.jsx)("input",{type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?",value:k,onChange:function(e){return y(e.target.value)},disabled:I})})]}),Object(E.jsx)("section",{className:"todoapp__main","data-cy":"TodoList",children:U.map((function(e){return Object(E.jsx)(_,{todo:e,onDelete:V,onUpdate:J,updateTodo:h,todoEdit:z},e.id)}))}),a&&Object(E.jsxs)("footer",{className:"todoapp__footer",children:[Object(E.jsx)("span",{className:"todo-count",children:"".concat(w.length," items left")}),Object(E.jsxs)("nav",{className:"filter",children:[Object(E.jsx)("a",{href:"#/",className:d()("filter__link",{selected:A===R.ALL}),onClick:function(){return L(R.ALL)},children:"All"}),Object(E.jsx)("a",{href:"#/active",className:d()("filter__link",{selected:A===R.ACTIVE}),onClick:function(){return L(R.ACTIVE)},children:"Active"}),Object(E.jsx)("a",{href:"#/completed",className:d()("filter__link",{selected:A===R.COMPLETED}),onClick:function(){return L(R.COMPLETED)},children:"Completed"})]}),Object(E.jsx)("button",{type:"button",className:"todoapp__clear-completed",onClick:function(){u(a.filter((function(e){return!1===e.completed||(p(e.id),!1)})))},disabled:P.length<=0,children:"Clear completed"})]})]}),Object(E.jsxs)("div",{className:d()("notification is-danger","is-light","has-text-weight-normal",{hidden:f===N.NONE}),children:[Object(E.jsx)("button",{type:"button","aria-label":"button",className:"delete",onClick:function(){return F()}}),f===N.ADD_ERROR&&Object(E.jsx)("div",{children:"Unable to add a todo"}),f===N.DELETE_ERROR&&Object(E.jsx)("div",{children:"Unable to delete a todo"}),f===N.UPDATE_ERROR&&Object(E.jsx)("div",{children:"Unable to update a todo"})]})]})},v=(n(24),function(e){return e[e.NONE=0]="NONE",e[e.EMAILERROR=1]="EMAILERROR",e[e.NAMEERROR=2]="NAMEERROR",e}({})),g=function(e){var t=e.setUserEmail,n=e.userEmail,c=e.formSubmit,o=e.errorInput,r=e.secVisIn,a=e.setUserName,i=e.userName;return Object(E.jsx)("div",{className:"form__block",children:Object(E.jsx)("div",{className:"form__content",children:Object(E.jsxs)("form",{className:"form",onSubmit:function(e){return c(e)},children:[r?Object(E.jsx)("h1",{className:"form__title",children:"You need to register"}):Object(E.jsx)("h1",{className:"form__title",children:"Log in to open todos"}),Object(E.jsxs)("div",{className:"form__field",children:[Object(E.jsx)("label",{className:"form__label",htmlFor:"input-email",children:"Email"}),Object(E.jsxs)("div",{className:"form__input-block",children:[Object(E.jsx)("input",{type:"email",className:d()("form__input",{error:o===v.EMAILERROR}),placeholder:"Enter your email",value:n,id:"input-email",onChange:function(e){return t(e.target.value)},required:!1,disabled:r}),Object(E.jsx)("span",{className:"form__icon form__icon--envelope"})]}),o===v.EMAILERROR&&Object(E.jsx)("p",{className:"form__error",children:"Invalid address entered"})]}),r&&Object(E.jsxs)("div",{className:"form__field",children:[Object(E.jsx)("label",{className:"form__label",htmlFor:"input-user",children:"Your Name"}),Object(E.jsxs)("div",{className:"form__input-block",children:[Object(E.jsx)("input",{type:"text",id:"input-user",className:d()("form__input",{error:o===v.NAMEERROR}),placeholder:"Enter your name",value:i,onChange:function(e){return a(e.target.value)}}),Object(E.jsx)("span",{className:"form__icon form__icon--user"})]}),o===v.NAMEERROR&&Object(E.jsx)("p",{className:"form__error",children:"Invalid name"})]}),Object(E.jsx)("div",{className:"form__field",children:Object(E.jsx)("button",{type:"submit",className:"form__button",children:r?"Register":"Login"})})]})})})},A=function(e){return e[e.NONE=0]="NONE",e[e.EMAILERROR=1]="EMAILERROR",e[e.NAMEERROR=2]="NAMEERROR",e}({}),L=function(){var e=Object(c.useState)(""),t=Object(i.a)(e,2),n=t[0],o=t[1],r=Object(c.useState)(""),a=Object(i.a)(r,2),s=a[0],l=a[1],u=Object(c.useState)(A.NONE),d=Object(i.a)(u,2),j=d[0],b=d[1],f=Object(c.useState)(!1),p=Object(i.a)(f,2),h=p[0],_=p[1],N=function(e,t){var n=Object(c.useState)((function(){try{var n=localStorage.getItem(e);return n?JSON.parse(n):t}catch(c){return t}})),o=Object(i.a)(n,2),r=o[0],a=o[1];return[r,function(t){a(t),localStorage.setItem(e,JSON.stringify(t))}]}("user",[]),R=Object(i.a)(N,2),v=R[0],L=R[1];return v.length>0?Object(E.jsx)(x,{user:v[0]}):Object(E.jsx)(g,{setUserEmail:o,userEmail:n,formSubmit:function(e){e.preventDefault(),new RegExp("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$").test(n)?(m("/users?email=".concat(n)).then((function(e){return L(e)})),_(!0),b(A.NONE),s.length>=4?(O("/users",{name:s,email:n}),b(A.NONE)):0!==s.length&&b(A.NAMEERROR)):b(A.EMAILERROR)},errorInput:j,secVisIn:h,setUserName:l,userName:s})};r.a.render(Object(E.jsx)(a.a,{children:Object(E.jsx)(L,{})}),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.47fa7a2e.chunk.js.map